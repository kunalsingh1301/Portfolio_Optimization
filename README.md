AnalysisException: Column 'rn' does not exist. Did you mean one of the following? [channel, user_id, event_ts, starter_channel]; 'Project [user_id#8222, event_ts#8205, channel#8223, starter_channel#9821, sum(CASE WHEN ('rn = 1) THEN 1 ELSE 0 END) windowspecdefinition(user_id#8222, event_ts#8205 ASC NULLS FIRST, unspecifiedframe$()) AS case_id#9952] +- Project [user_id#8222, event_ts#8205, channel#8223, starter_channel#9821] +- Join Inner, (user_id#8222 = user_id#9941) :- RepartitionByExpression [user_id#8222] : +- Filter atleastnnonnulls(2, user_id#8222, event_ts#8205) : +- Union false, false : :- Project [user_id#8145 AS user_id#8222, event_ts#8205, Stacy AS channel#8223] : : +- Project [user_id#8145, session_id#8146, segment#8147, HKT#8148, event_ts#8205] : : +- Project [user_id#8145, session_id#8146, segment#8147, HKT#8148, _raw_ts#8154, _excel_days#8160, _excel_fraction#8167, _excel_value#8175, _excel_ts#8184, _string_ts#8194, CASE WHEN isnotnull(_excel_ts#8184) THEN _excel_ts#8184 ELSE _string_ts#8194 END AS event_ts#8205] : : +- Project [user_id#8145, session_id#8146, segment#8147, HKT#8148, _raw_ts#8154, _excel_days#8160, _excel_fraction#8167, _excel_value#8175, _excel_ts#8184, coalesce(to_timestamp(_raw_ts#8154, Some(dd-MM-yyyy HH:mm:ss), TimestampType, Some(Asia/Hong_Kong)), to_timestamp(_raw_ts#8154, Some(dd-MM-yyyy hh:mm:ss a), TimestampType, Some(Asia/Hong_Kong)), to_timestamp(_raw_ts#8154, Some(dd-MM-yyyy HH:mm), TimestampType, Some(Asia/Hong_Kong)), to_timestamp(_raw_ts#8154, Some(dd-MM-yyyy hh:mm a), TimestampType, Some(Asia/Hong_Kong)), to_timestamp(_raw_ts#8154, Some(dd-MM-yy HH:mm:ss), TimestampType, Some(Asia/Hong_Kong)), to_timestamp(_raw_ts#8154, Some(dd-MM-yy hh:mm:ss a), TimestampType, Some(Asia/Hong_Kong)), to_timestamp(_raw_ts#8154, Some(dd-MM-yy HH:mm), TimestampType, Some(Asia/Hong_Kong)), to_timestamp(_raw_ts#8154, Some(dd-MM-yy hh:mm a), TimestampType, Some(Asia/Hong_Kong)), to_timestamp(_raw_ts#8154, Some(d-M-yyyy HH:mm:ss), TimestampType, Some(Asia/Hong_Kong)), to_timestamp(_raw_ts#8154, Some(d-M-yyyy hh:mm:ss a), TimestampType, Some(Asia/Hong_Kong)), to_timestamp(_raw_ts#8154, Some(d-M-yyyy HH:mm), TimestampType, Some(Asia/Hong_Kong)), to_timestamp(_raw_ts#8154, Some(d-M-yyyy hh:mm a), TimestampType, Some(Asia/Hong_Kong)), to_timestamp(_raw_ts#8154, Some(d-M-yy HH:mm:ss), TimestampType, Some(Asia/Hong_Kong)), to_timestamp(_raw_ts#8154, Some(d-M-yy hh:mm:ss a), TimestampType, Some(Asia/Hong_Kong)), to_timestamp(_raw_ts#8154, Some(d-M-yy HH:mm), TimestampType, Some(Asia/Hong_Kong)), to_timestamp(_raw_ts#8154, Some(d-M-yy hh:mm a), TimestampType, Some(Asia/Hong_Kong)), to_timestamp(_raw_ts#8154, Some(dd/MM/yyyy HH:mm:ss), TimestampType, Some(Asia/Hong_Kong)), to_timestamp(_raw_ts#8154, Some(dd/MM/yyyy hh:mm:ss a), TimestampType, Some(Asia/Hong_Kong)), to_timestamp(_raw_ts#8154, Some(dd/MM/yyyy HH:mm), TimestampType, Some(Asia/Hong_Kong)), to_timestamp(_raw_ts#8154, Some(dd/MM/yyyy hh:mm a), TimestampType, Some(Asia/Hong_Kong)), to_timestamp(_raw_ts#8154, Some(dd/MM/yy HH:mm:ss), TimestampType, Some(Asia/Hong_Kong)), to_timestamp(_raw_ts#8154, Some(dd/MM/yy hh:mm:ss a), TimestampType, Some(Asia/Hong_Kong)), to_timestamp(_raw_ts#8154, Some(dd/MM/yy HH:mm), TimestampType, Some(Asia/Hong_Kong)), to_timestamp(_raw_ts#8154, Some(dd/MM/yy hh:mm a), TimestampType, Some(Asia/Hong_Kong)), ... 20 more fields) AS _string_ts#8194] : : +- Project [user_id#8145, session_id#8146, segment#8147, HKT#8148, _raw_ts#8154, _excel_days#8160, _excel_fraction#8167, _excel_value#8175, CASE WHEN isnotnull(_excel_value#8175) THEN timestampadd(SECOND, cast(((_excel_value#8175 - cast(25569 as double)) * cast(86400 as double)) as int), cast(1970-01-01 as timestamp), Some(Asia/Hong_Kong)) END AS _excel_ts#8184] : : +- Project [user_id#8145, session_id#8146, segment#8147, HKT#8148, _raw_ts#8154, _excel_days#8160, _excel_fraction#8167, CASE WHEN isnotnull(_excel_days#8160) THEN (_excel_days#8160 + _excel_fraction#8167) END AS _excel_value#8175] : : +- Project [user_id#8145, session_id#8146, segment#8147, HKT#8148, _raw_ts#8154, _excel_days#8160, CASE WHEN isnotnull(_excel_days#8160) THEN cast(split(_raw_ts#8154, \s+, -1)[1] as double) END AS _excel_fraction#8167] : : +- Project [user_id#8145, session_id#8146, segment#8147, HKT#8148, _raw_ts#8154, CASE WHEN RLIKE(_raw_ts#8154, ^\d+\s+\d*\.\d+$) THEN cast(split(_raw_ts#8154, \s+, -1)[0] as double) END AS _excel_days#8160] : : +- Project [user_id#8145, session_id#8146, segment#8147, HKT#8148, regexp_replace(trim(HKT#8148, None), \s+, , 1) AS _raw_ts#8154] : : +- Filter (isnotnull(user_id#8145) AND NOT (trim(user_id#8145, None) = )) : : +- Relation [user_id#8145,session_id#8146,segment#8147,HKT#8148] csv : :- Project [user_id#8323, event_ts#8306, channel#8324] : : +- Project [user_id#8246 AS user_id#8323, event_ts#8306, Stacy AS channel#8324] : : +- Project [user_id#8246, session_id#8247, segment#8248, HKT#8249, event_ts#8306] : : +- Project [user_id#8246, session_id#8247, segment#8248, HKT#8249, _raw_ts#8255, _excel_days#8261, _excel_fraction#8268, _excel_value#8276, _excel_ts#8285, _string_ts#8295, CASE WHEN isnotnull(_excel_ts#8285) THEN _excel_ts#8285 ELSE _string_ts#8295 END AS event_ts#8306] : : +- Project [user_id#8246, session_id#8247, segment#8248, HKT#8249, _raw_ts#8255, _excel_days#8261, _excel_fraction#8268, _excel_value#8276, _excel_ts#8285, coalesce(to_timestamp(_raw_ts#8255, Some(dd-MM-yyyy HH:mm:ss), TimestampType, Some(Asia/Hong_Kong)), to_timestamp(_raw_ts#8255, Some(dd-MM-yyyy hh:mm:ss a), TimestampType, Some(Asia/Hong_Kong)), to_timestamp(_raw_ts#8255, Some(dd-MM-yyyy HH:mm), TimestampType, Some(Asia/Hong_Kong)), to_timestamp(_raw_ts#8255, Some(dd-MM-yyyy hh:mm a), TimestampType, Some(Asia/Hong_Kong)), to_timestamp(_raw_ts#8255, Some(dd-MM-yy HH:mm:ss), TimestampType, Some(Asia/Hong_Kong)), to_timestamp(_raw_ts#8255, Some(dd-MM-yy hh:mm:ss a), TimestampType, Some(Asia/Hong_Kong)), to_timestamp(_raw_ts#8255, Some(dd-MM-yy HH:mm), TimestampType, Some(Asia/Hong_Kong)), to_timestamp(_raw_ts#8255, Some(dd-MM-yy hh:mm a), TimestampType, Some(Asia/Hong_Kong)), to_timestamp(_raw_ts#8255, Some(d-M-yyyy HH:mm:ss), TimestampType, Some(Asia/Hong_Kong)), to_timestamp(_raw_ts#8255, Some(d-M-yyyy hh:mm:ss a), TimestampType, Some(Asia/Hong_Kong)), to_timestamp(_raw_ts#8255, Some(d-M-yyyy HH:mm), TimestampType, Some(Asia/Hong_Kong)), to_timestamp(_raw_ts#8255, Some(d-M-yyyy hh:mm a), TimestampType, Some(Asia/Hong_Kong)), to_timestamp(_raw_ts#8255, Some(d-M-yy HH:mm:ss), TimestampType, Some(Asia/Hong_Kong)), to_timestamp(_raw_ts#8255, Some(d-M-yy hh:mm:ss a), TimestampType, Some(Asia/Hong_Kong)), to_timestamp(_raw_ts#8255, Some(d-M-yy HH:mm), TimestampType, Some(Asia/Hong_Kong)), to_timestamp(_raw_ts#8255, Some(d-M-yy hh:mm a), TimestampType, Some(Asia/Hong_Kong)), to_timestamp(_raw_ts#8255, Some(dd/MM/yyyy HH:mm:ss), TimestampType, Some(Asia/Hong_Kong)), to_timestamp(_raw_ts#8255, Some(dd/MM/yyyy hh:mm:ss a), TimestampType, Some(Asia/Hong_Kong)), to_timestamp(_raw_ts#8255, Some(dd/MM/yyyy HH:mm), TimestampType, Some(Asia/Hong_Kong)), to_timestamp(_raw_ts#8255, Some(dd/MM/yyyy hh:mm a), TimestampType, Some(Asia/Hong_Kong)), to_timestamp(_raw_ts#8255, Some(dd/MM/yy HH:mm:ss), TimestampType, Some(Asia/Hong_Kong)), to_timestamp(_raw_ts#8255, Some(dd/MM/yy hh:mm:ss a), TimestampType, Some(Asia/Hong_Kong)), to_timestamp(_raw_ts#8255, Some(dd/MM/yy HH:mm), TimestampType, Some(Asia/Hong_Kong)), to_timestamp(_raw_ts#8255, Some(dd/MM/yy hh:mm a), TimestampType, Some(Asia/Hong_Kong)), ... 20 more fields) AS _string_ts#8295] : : +- Project [user_id#8246, session_id#8247, segment#8248, HKT#8249, _raw_ts#8255, _excel_days#8261, _excel_fraction#8268, _excel_value#8276, CASE WHEN isnotnull(_excel_value#8276) THEN timestampadd(SECOND, cast(((_excel_value#8276 - cast(25569 as double)) * cast(86400 as double)) as int), cast(1970-01-01 as timestamp), Some(Asia/Hong_Kong)) END AS _excel_ts#8285] : : +- Project [user_id#8246, session_id#8247, segment#8248, HKT#8249, _raw_ts#8255, _excel_days#8261, _excel_fraction#8268, CASE WHEN isnotnull(_excel_days#8261) THEN (_excel_days#8261 + _excel_fraction#8268) END AS _excel_value#8276] : : +- Project [user_id#8246, session_id#8247, segment#8248, HKT#8249, _raw_ts#8255, _excel_days#8261, CASE WHEN isnotnull(_excel_days#8261) THEN cast(split(_raw_ts#8255, \s+, -1)[1] as double) END AS _excel_fraction#8268] : : +- Project [user_id#8246, session_id#8247, segment#8248, HKT#8249, _raw_ts#8255, CASE WHEN RLIKE(_raw_ts#8255, ^\d+\s+\d*\.\d+$) THEN cast(split(_raw_ts#8255, \s+, -1)[0] as double) END AS _excel_days#8261] : : +- Project [user_id#8246, session_id#8247, segment#8248, HKT#8249, regexp_replace(trim(HKT#8249, None), \s+, , 1) AS _raw_ts#8255] : : +- Filter (isnotnull(user_id#8246) AND NOT (trim(user_id#8246, None) = )) : : +- Relation [user_id#8246,session_id#8247,segment#8248,HKT#8249] csv : :- Project [user_id#8904, event_ts#8791, channel#8905] : : +- Project [Customer No (CTI)#8376 AS user_id#8904, event_ts#8791, Call AS channel#8905] : : +- Project [Call Activity ID#8347, Agent Bank ID#8348, Agent Full Name#8349, Country#8350, Type#8351, Verification Status#8352, Call Statu
